
/ Modal
#manageRelease.modal.fade(aria-hidden="true" aria-labelledby="Create Release" role="dialog" tabindex="-1" ng-cloak)
  .modal-dialog.modal-lg
    .modal-content
      .modal-header
        %button.close(data-dismiss="modal" type="button")
          %span(aria-hiddena="true") Ã—
          %span.sr-only Close
        %h4#myModalLabel.modal-title
          Manage Releases

      .modal-body

        .well(ng-class="{'hide':!release}")
          .panel.panel-info
            .panel-heading
              %h3.panel-title {{mode.title}} Release
            .panel-body
              %form.form-horizontal(role="form" )
                .form-group
                  %label.col-sm-2.control-label(for="inputName") Release name
                  .col-sm-10
                    %input#inputName.form-control(ng-model="release.name" placeholder="Name" required=true)/

                .form-group
                  %label.col-sm-2.control-label(for="cost") Cost
                  .col-sm-5
                    .input-group
                      .input-group-addon $
                      %input#cost.form-control(ng-model="release.cost" placeholder="cost" size="30" required=true type="text" tep="0.01" name="cost"  )/

                  .col-sm-5(ng-class="{'hide':!release.cost }" style="padding:5px")
                    {{release.cost | currency:"$"}}

                  .col-sm-5(ng-class="{'hide':release.cost }" )
                    %button.btn.btn-info( ng-click="release.cost = release.calculated_cost")
                      Use Calculated Cost {{release.calculated_cost | currency:"$"}}

                .form-group(ng-class="{'hide': release.cost == release.calculated_cost}")
                  .alert.alert-warning
                    .col-sm-7
                      The release cost & sprints cost do not match
                    .col.sm-3
                      %button.btn.btn-warning( ng-click="release.cost = release.calculated_cost")
                        Use Calculated Cost {{release.calculated_cost | currency:"$"}} ?


                .form-group
                  %label.col-sm-2.control-label(for="inputDescription") Description
                  .col-sm-10
                    %input#inputDescription.form-control( ng-model="release.description" placeholder="Description" )/

                .form-group
                  %label.col-sm-2.control-label(for="inputReleaseDate" ) Release Date
                  .col-sm-10
                    %div.input-group.date
                      %input#release-date.datepicker.form-control( type="text" ng-model="release.release_date" required=true)
                        %span.input-group-addon
                          %i.glyphicon.glyphicon-th

                .form-group
                  %label.col-sm-2.control-label{for: "inputPassword3"} Sprints
                  .col-sm-10

                    .panel.panel-info(ng-class="{'hide': !release.sprints.length}")
                      .panel-heading
                        %h3.panel-title
                          Sprints included in release
                          %span.very-quiet (click to remove)
                          %span(style="color:black") Calculated Cost {{release.calculated_cost | currency:"$"}}
                      .panel-body
                        %table.table.table-striped.table-hover
                          %tbody
                            %tr( ng-repeat="sprint in release.sprints" style="cursor: pointer" ng-click="removeSprintFromRelease(sprint)" )
                              %td
                                {{sprint.name}}
                                %span.very-quiet : {{sprint.start_date}} - {{sprint.end_date}}
                              %td.col-md-3
                                {{sprint.cost | currency:"$"}}

                    .panel.panel-warning.hide(ng-class="{'hide': !sprints.length}")
                      .panel-heading
                        %h3.panel-title
                          Available Sprints
                          %span.quiet (click to add)
                          %span(style="color:black") Calculated Cost {{unreleased_sprint_costs | currency:"$"}}

                      .panel-body
                        %table.table.table-striped.table-hover
                          %tbody
                            %tr( ng-repeat="sprint in sprints" style="color:#666; cursor: pointer" ng-click="addSprintToRelease(sprint)" )
                              %td {{sprint.name}} : {{sprint.start_date}} - {{sprint.end_date}}
                              %td.col-md-3 {{sprint.cost | currency:"$"}}

                    .alert.alert-danger.hide( ng-cloak=true role="alert" ng-class="{'hide': release.sprints.length || sprints.length}")
                      No closed sprints available.
                      Perhaps sprints are wrongfully added to another release

                .form-group
                  .col-sm-offset-2.col-sm-8
                    %button.btn.btn-primary( ng-disabled="!canSave()" type="submit" ng-click="saveRelease()")
                      Save
                    %button.btn.btn-default(ng-click="cancelRelease()" formnovalidate) Cancel
                  .col-sm-2
                    %button.hide.btn.btn-danger(ng-class="{'hide': mode.action != 'update'}" ng-click="deleteRelease()" formnovalidate) Delete
                .form-group
                  .col-sm-offset-2.col-sm-8
                    .alert.alert-warning(ng-class="{'hide': canSave()}")
                      Can't save unless Release Name & Date are filled out

        .panel.panel-default
          .panel-body
            %button(ng-click="newRelease()") Create a NEW release

        .alert.alert-info( role="alert" ng-class="{'hide': releases && releases.length}")
          There are no releases for this board

        %div.hide(ng-class="{'hide': !releases || !releases.length}")
          %table.table.table-striped.table-hover
            %thead
              %tr
                %td Release Name
                %td Description
                %td Date
                %td Cost
                %td Sprints

            %tbody
              %tr( ng-repeat="release in releases" style="cursor: pointer" ng-click="editRelease(release)" )
                %td {{release.name}}
                %td {{release.description}}
                %td {{release.release_date}}
                %td
                  %span(ng-class="{'hide':!release.cost }") {{release.cost || release.calculated_cost | currency:"$"}}
                  %span(ng-class="{'hide':release.cost || !release.calculated_cost}")
                    %span {{release.cost || release.calculated_cost | currency:"$"}}
                    %span.quiet (calculated)
                  .quiet(ng-class="{'hide':release.cost || release.calculated_cost }")
                %td
                  %span( ng-repeat="sprint in release.sprints" )
                    {{sprint.name}}{{$last ? '' : ', '}}

      .modal-footer
        %button.btn.btn-default(data-dismiss="modal" type="button") Close
