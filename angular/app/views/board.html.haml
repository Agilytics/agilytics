
%nav.navbar.navbar-default{role: "navigation"}
  .container-fluid
    .navbar-header
      %button.navbar-toggle{"data-target" => "#bs-example-navbar-collapse-2", "data-toggle" => "collapse", type: "button"}
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      .navbar-brand {{board.name}}
    #bs-example-navbar-collapse-2.collapse.navbar-collapse
      %form.navbar-form.navbar-left
        .form-group
          .btn-group
            %button.btn.btn-primary( ng-click="releaseManager.open()")
              Manage Releases

      .navbar-form.nav.navbar-nav.navbar-right
        .btn-group
          %button.btn.btn-default( ng-click="detail=true" ng-class="{'active':detail}" type="button" ) DETAIL ON
          %button.btn.btn-default( ng-click="detail=false" ng-class="{'active':!detail}" type="button" ) OFF

      .navbar-form.nav.navbar-nav.navbar-right
        %button.btn.btn-default( ng-class="{'hide':edit}" ng-click="editBoard()" ) Edit
        %button.btn.btn-warning( ng-class="{'hide':!edit}" ng-click="cancelEdit()" ) Close Edit

%release-management( board="board" control="releaseManager")

.panel.panel-default(ng-class="{'hide':!edit}")
  .panel-heading
    %h3.panel-title Board Detail
  .panel-body
    %form.form-horizontal(role="form" )
      .form-group
        %label.col-sm-2.control-label(for="inputName") Board name
        .col-sm-10
          %input#inputName.form-control(ng-model="board.name" placeholder="Name" required=true)/

      .form-group
        %label.col-sm-2.control-label(for="cost") Run Rate: $ per sprint
        .row
          .col-sm-5
            .input-group
              .input-group-addon $
              %input#cost.form-control(ng-model="board.run_rate_cost" placeholder="cost" size="30" required=true type="text" tep="0.01" name="cost"  )/

          .col-sm-4(style="padding:5px")
            {{board.run_rate_cost | currency:"$"}}

      .form-group
        .col-sm-offset-2.col-sm-8
          .alert.alert-info(ng-class="{'hide': canSaveBoard()}")
            If you enter the cost, release cost can be calculated per sprint.

      .form-group
        .col-sm-offset-2.col-sm-10
          %button.btn.btn-primary(ng-disabled="!canSaveBoard()" ng-click="saveBoard()") Save
          %button.btn.btn-warning( ng-click="edit=false" ) Cancel

-#CATEGORY
.panel.panel-default(ng-class="{'hide':!edit}")
  .panel-heading
    %h3.panel-title Board categories:

  -#CATEGORIES
  .panel-body
    %table.table.table-striped.table-hover.hide( ng-class="{'hide': !board.categories || !board.categories.length}" )
      %tbody
        %tr( ng-repeat="category in board.categories" )
          %td( style="cursor: pointer" ng-click="editCategory(category)" )
            {{category.name}}
          %td( style="cursor: pointer" ng-click="editCategory(category)" )
            %span( ng-repeat="tag in category.tags" )
              {{tag.name}}{{$last ? '' : ', '}}
          %td.col-md-1( style="cursor: pointer" ng-click="deleteCategory(category)" )
            %button.btn.btn-warning
              X

    %button.btn.btn-warning( type="submit" ng-click="createCategory()" ng-class="{'hide': !!(category || board.categories.length) }" )
      No Categories: Create One

    %button.hide.btn.btn-primary( type="submit" ng-click="createCategory()" ng-class="{'hide': category || !board.categories.length }" )
      Add Category

  .panel-body
    -# EDIT CATEGORY
    %form.form-horizontal.hide( ng-class="{'hide': !category }" )
      .form-group
        %label.col-sm-2.control-label(for="inputName") Name
        .col-sm-10
          %input#inputName.form-control(ng-model="category.name" placeholder="Name" required=true)


      -##############################################################

      .form-group
        %label.col-sm-2.control-label(for="inputName") Tags
        .col-sm-10
          .panel.panel-info(ng-class="{'hide': !category.tags.length}")
            .panel-heading
              %h3.panel-title
                Tags included in category
                %span.very-quiet (click to remove)
            .panel-body
              %table.table.table-striped.table-hover
                %tbody
                  %tr( ng-repeat="tag in category.tags" style="cursor: pointer" ng-click="removeTagFromCategory(tag, category)" )
                    %td
                      {{tag.name}}

          .panel.panel-warning.hide(ng-class="{'hide': !tags.length}")
            .panel-heading
              %h3.panel-title
                Available Tags
                %span.quiet (click to add)

            .panel-body
              %table.table.table-striped.table-hover
                %tbody
                  %tr( ng-repeat="tag in tags" style="color:#666; cursor: pointer" ng-click="addTagToCategory(tag, category)" )
                    %td
                      {{ tag.name }}

          .alert.alert-danger.hide( ng-cloak=true role="alert" ng-class="{'hide': category.tags.length || tags.length}")
            No more tags available.

      -##############################################################

      .form-group
        .col-sm-offset-2.col-sm-10
          %button.btn.btn-primary(ng-disabled="!canSaveCategory(category)" ng-click="saveCategory(category)") Save
          %button.btn.btn-warning( ng-click="cancelEditCategory(category)" ) Cancel



.row
  %release-and-costs( board="board" )

.row
  %div.col-md-6#velocity(style="min-width: 310px; height: 400px; margin: 0 auto")
  %div.col-md-6#velocityPercent(style="min-width: 310px; height: 400px; margin: 0 auto")

%table.table.table-striped.table-hover( ng-class="{ 'hide' : !detail }" )
  %thead
    %tr
      %td sprint name

      %td(ng-repeat="category in board.categories") {{category.name}}
      %td total
      %td(ng-repeat="category in board.categories") {{category.name}} %



  %tbody
    %tr( ng-repeat="stat in stats" )
      %td {{stat.sprint_name}}
      %td(ng-repeat="category in board.categories") {{stat["cat_" + category.id + "_velocity"] }}
      %td {{stat.total_velocity}}
      %td(ng-repeat="category in board.categories") {{stat["cat_" + category.id + "_percentage_velocity"] }}

.row
  %div.col-md-6#counts(style="min-width: 310px; height: 400px; margin: 0 auto")
  %div.col-md-6#countsPercent(style="min-width: 310px; height: 400px; margin: 0 auto")

%table.table.table-striped.table-hover( ng-class="{ 'hide' : !detail }" )
  %thead
    %tr
      %td sprint name
      %td feature
      %td enhancement
      %td bug
      %td total
      %td feature %
      %td enhancements %
      %td bug %

  %tbody
    %tr( ng-repeat="stat in stats" ng-click="href(board)" style="cursor: pointer" )

      %td {{stat.sprint_name}}
      %td {{stat.feature_count}}
      %td {{stat.enhancement_count}}
      %td {{stat.bug_count}}
      %td {{stat.total_count}}
      %td {{stat.feature_percentage_count}}%
      %td {{stat.enhancements_percentage_count}}%
      %td {{stat.bug_percentage_count}}%



